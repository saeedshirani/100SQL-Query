--Q4.	Calculate the total revenue per category for the year 2017

select pct.product_category_name_english, sum(orit.price) as total_revenue
from order_items as orit
         left join products as p
                   on p.product_id = orit.product_id
        left join product_category_name_translation as pct
        on  pct.product_category_name = p.product_category_name
where orit.order_id in (
    -- subquery for selecting year
   select orit.order_id

    from orders as o
             left join order_items as orit
        on o.order_id = orit.order_id
    where  cast(strftime("%Y", order_purchase_timestamp) as integer) == 2017
)


group by  p.product_category_name;
